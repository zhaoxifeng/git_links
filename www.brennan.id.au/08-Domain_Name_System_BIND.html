<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>













  
  
  
  
  
  
  
  
  
  
  
  
  
  <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">













  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <title>Linux Home Server HOWTO - Domain Name System (BIND)</title>
  <meta content="Miles Brennan" name="author">
</head>


<body>













<div style="text-align: center;"><span style="font-weight: bold;"><a name="top"></a>Linux
Home Server HOWTO</span><br>













</div>













<table style="width: 100%;" border="0" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="width: 30%; text-align: left;"><a href="07-Package_Management.html">Previous</a><br>













      </td>













      <td style="width: 40%; text-align: center;"><a href="index.html">Home</a>
      </td>













      <td style="width: 30%; text-align: right;"><a href="09-Network_Time_Protocol.html">Next</a><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<hr>
<h1>Chapter 8 - Domain Name System
(BIND)</h1>



<table style="text-align: left; width: 100%;" border="0" cellpadding="1" cellspacing="1">












  <tbody>












    <tr>












      <td style="width: 140px;"><span style="font-weight: bold;">Version:</span></td>












      <td>- bind 9.3.2</td>












    </tr>












  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<span style="font-weight: bold;"></span><br>













<a href="#initial"><span style="color: rgb(255, 0, 0); font-weight: bold;"></span>Initial
Configuration</a><br>













<a href="#options">Setting
Daemon Options</a><br>













<a href="#yourdomain">Adding
Your Domain</a><br>













<a href="#starting">Starting
BIND</a><br>













<a href="#testing">Testing
The Server</a><br>











<a href="#dynamic_dns">Configuring Dynamic DNS</a><br>













<br>













The Domain Name System (or Service) provides a naming resolution
service that makes it easy for us humans to use the Internet, among
other tasks. Every computer located on the Internet that is publicly
accessible uses an unique Internet address, but these Internet
addresses are numerical in nature and difficult to remember. To
download the latest Linux kernel I point my browser to <a href="http://www.kernel.org">www.kernel.org</a>,
but the server is
located at the Internet address of <a href="http://204.152.191.5">204.152.191.5</a>,
I know which address I would prefer to remember.<br>













<br>













The global DNS provides listings for publicly accessible addresses. If
you need to access any computer resources inside your own network and
your network is using <a href="http://www.ietf.org/rfc/rfc1918.txt">RFC1918</a>
private address allocation, then you will not be able to use the public
DNS to resolve your internal network resources. This can be fixed by
introducing your own DNS for the internal network.<br>













<br>













This chapter will provide the steps necessary to configure your own DNS
server to assist in internal name resolution and to provide a caching
service for external domains. The Berkeley Internet Name Domain (BIND)
software is installed on most Linux distributions, and is also
available from the <a href="http://www.isc.org">Internet
Systems
Consortium</a> site.<br>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>If you are using a
dynamic IP address and you would like to
host your
own website and email servers, then you will also need to review the
Dynamic DNS details in
Chapter 5. </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<h2><a name="initial"></a><a href="#top">Initial
Configuration</a><br>













</h2>













For a Linux host to use DNS, the system resolver must be told which
name servers to use. This information is stored in the <span style="font-family: monospace;">/etc/resolv.conf</span>
file. As with
any configuration, we should always backup the original configuration
file before editing it.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">cp
/etc/resolv.conf /etc/resolv.conf.original</span><br>













[bash]# <span style="font-weight: bold;">vi /etc/resolv.conf</span> </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The resolver on the new DNS server needs to be adjusted so it points to
itself for name resolution. Be sure to substitute "<span style="font-family: monospace;">example.com</span>"
for the domain(s)
you are configuring.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>search example.com<br>













nameserver 127.0.0.1 </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The <span style="font-family: monospace;">search</span>
parameter
defines a list of domains that will be searched when doing hostname
queries. The <span style="font-family: monospace;">nameserver</span>
parameter lists the DNS servers that the host should use for name
resolution, in this case itself.<br>













<br>













For more information on the system resolver, type "<span style="font-family: monospace;">man
resolv.conf</span>" at the command
prompt.<br>













<br>













<h2><a name="options"></a><a href="#top">Setting
Daemon Options</a></h2>













The name of the DNS daemon in the BIND package is funnily enough called
<span style="font-family: monospace;">named</span>,
and the main
configuration file is located in <span style="font-family: monospace;">/etc/named.conf</span>.
The configuration can be quite daunting to the new, so lets back it up
before making any changes.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">cp
/etc/named.conf /etc/named.conf.original</span><br>













[bash]#
      <span style="font-weight: bold;">vi /etc/named.conf</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The main configuration file is split into many sections. To configure <span style="font-family: monospace;">named</span>
to only allow queries
from the local server and internal network hosts, add the <span style="font-family: monospace;">"listen-on"</span>
and&nbsp;<span style="font-family: monospace;">"allow-query"</span>
options. This will
restrict unwanted queries on your server.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td><span style="font-family: monospace;">options
{</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: monospace;">directory
"/var/named";</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: monospace;">dump-file
"/var/named/data/cache_dump.db";</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: monospace;">statistics-file
"/var/named/data/named_stats.txt";</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: monospace;">/*</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </span><span style="font-family: monospace;">*
If there is a firewall between you and nameservers you want</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      </span><span style="font-family: monospace;">*
to talk to, you might need to uncomment the query-source</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
* directive below.&nbsp; Previous versions of BIND always asked</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
* questions using port 53, but BIND 8.1 uses an unprivileged</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
* port by default.</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
*/</span><br style="font-family: monospace;">













      <span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
//query-source address * port 53;</span><br>













      <span style="font-family: monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;
listen-on {
127.0.0.1; 192.168.1.1; };</span><br style="font-weight: bold;">













      <span style="font-family: monospace; font-weight: bold;">&nbsp;&nbsp;&nbsp;&nbsp;
allow-query {
127.0.0.1; 192.168.1.0/24; };</span><br style="font-family: monospace;">













      <span style="font-family: monospace;"></span><span style="font-family: monospace;">};<br>













      </span> </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













If your DNS server is located behind a firewall and is having
difficulty with resolving names, you may need to uncomment this directive.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td><span style="font-family: monospace;">query-source
address *
port 53;</span> </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The "." zone below tells named to check this file for a list of the
root name
servers, so it knows where to send external queries. This enables the
caching
nameserver feature of BIND, by forwarding any unknown requests to the
root
nameservers listed in the file. This zone should already be
listed in the configuration.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td><span style="font-family: monospace;"></span><span style="font-family: monospace;">zone
"." IN {<br>













&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
type hint;<br>













&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
file "named.ca";<br>













};<br>













      </span> </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













You may find that sending every new DNS query to the root name servers
will be a little slow. This can be improved by sending all of your queries to a
quicker "upstream" DNS server which will process your request for you.
An upstream DNS server (like the ones at your ISP) may already have the
query you're after in its cache, or it will normally have a faster
backbone link to the root name servers.<br>













<br>













To use forwarders you need to have at least one upstream DNS server IP
address. Forwarders are a configuration option which needs to be placed
inside the "options" section (place under the <span style="font-family: monospace;">"allow-query"</span> option above).<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td><span style="font-family: monospace;">#Place
INSIDE 'options'<br>













      <br>













&nbsp;&nbsp;&nbsp;&nbsp; forward first;<br>













&nbsp;&nbsp;&nbsp;&nbsp; forwarders { xxx.xxx.xxx.xxx;
xxx.xxx.xxx.xxx;
}; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;-- Add your ISP's DNS servers in here (IP addresses ONLY)</span><br>













      </span> </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>Pay
particular attention to the format of the configuration file, missing
semicolons will
cause the daemon to function irrationally, if at all.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<h2><a name="yourdomain"></a><a href="#top">Adding Your
Domain</a></h2>













To provide resolution for the network and computer resources inside
your own private network, you need to configure your DNS with your own
master DNS zone. The examples below will now guide the configuration of a
master&nbsp;zone. These examples are more designed to provide DNS for an
internal private network (the home or small office user), and should be
used only as a basis for a full authoritative zone. It is also
suggested that you configure your domain externally for people to find
you on the Internet, see DDNS Service Providers in <a href="05-Broadband_Connectivity.html">Chapter 5</a> if you
don't have&nbsp;external name resolution.<br>













<br>













Firstly we need to set the zone information in the same <span style="font-family: monospace;">named</span>
configuration file we
used earlier, place the following configuration settings at the bottom of the <span style="font-family: monospace;">"/etc/named.conf"</span> file.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">vi
/etc/named.conf</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Caution !!" src="images/caution.gif"></td>













      <td>The <span style="font-weight: bold; font-family: monospace;">"example.com"</span>
domain name must be substituted for your domain in the following
examples.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>zone "example.com" IN {<br>













&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
type master;<br>













&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
file "data/master-example.com";<br>













&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
allow-update { none; };<br>













};<br>










      <br>










zone "1.168.192.in-addr.arpa" IN {<br>










&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type master;<br>










&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; file "data/reverse-192.168.1";<br>










&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allow-update { none; };<br>










}; </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The <span style="font-weight: bold; font-family: monospace;">"example.com"</span> zone will be configured as a master using the file "<span style="font-family: monospace;">master-example.com</span>"
to store all
the details about the zone entities (inside the <span style="font-family: monospace;">"/var/named/chroot/var/named/data"</span> directory).<br>













<br>













You should notice the configuration file is located inside a <span style="font-family: monospace;">chroot()</span>
jail directory, this
is a secure configuration typical of BIND installations. We will not
cover chroot here, but be aware of the importance of the directory
structure (some Linux versions may differ slightly though).<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">vi
/var/named/chroot/var/named/data/master-example.com</span> </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The following is an example FORWARD zone file for the "<span style="font-family: monospace;">example.com</span>"
domain name, it is
using private addressing for internal only name resolution.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>;<br>













;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Zone File
for "example.com" - Internal Use ONLY<br>













;<br>













$TTL 1D<br>













@ &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SOA &nbsp;&nbsp; &nbsp;&nbsp;
galaxy.example.com.&nbsp; sysadmin.example.com.&nbsp; (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; ; Serial<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
8H&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ; Refresh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2H&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; Retry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4W&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; Expire<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1D )&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; Minimum<br>













;<br>








&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN &nbsp;&nbsp;&nbsp;&nbsp;
NS&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
galaxy &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ; Name Server for the domain<br>








&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN &nbsp;&nbsp;&nbsp;&nbsp;
MX &nbsp;10 &nbsp; galaxy &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ;
Mail Exchange<br>













;<br>








example.com.&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
192.168.1.1&nbsp;&nbsp;&nbsp;&nbsp; ; IP address for
the domain 'example.com'<br>













galaxy &nbsp; &nbsp; &nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;
192.168.1.1&nbsp;&nbsp;&nbsp;&nbsp; ; IP address for
'galaxy'<br>













www&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; &nbsp; &nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CNAME&nbsp; &nbsp;
galaxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; 'galaxy' is also known as www<br>













ftp&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CNAME&nbsp; &nbsp;
galaxy&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; 'galaxy' is also known as ftp<br>













;<br>













wkstn1&nbsp; &nbsp; &nbsp; &nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;192.168.1.201&nbsp;&nbsp; ; MANUAL&nbsp;IP address entry for 'wkstn1'<br>













wkstn2&nbsp; &nbsp; &nbsp; &nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;192.168.1.202&nbsp;&nbsp; ; MANUAL IP address entry for 'wkstn2'<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>










The forward zone file allows name resolution from NAME to IP address.
To allow name resolution from IP address to NAME, we need to configure
a REVERSE zone file.<br>










<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">vi&nbsp;</span><span style="font-weight: bold;">/var/named/chroot/var/named/data/reverse-192.168.1</span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>










The reverse zone file looks similar to the forward zone file, however
you will note the IP addresses are listed first, with the names listed
after the pointer directive (PTR).<br>

<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>;<br>













;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Reverse File
for network "192.168.1.0/24" - Internal ONLY<br>













;<br>













$TTL 1D<br>













@ &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SOA &nbsp;&nbsp; &nbsp;&nbsp;
galaxy.example.com.&nbsp; sysadmin.example.com.&nbsp; (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; ; Serial<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
8H&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; Refresh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2H&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ; Retry<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4W&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Expire<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1D )&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Minimum<br>








;<br>













&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;
IN &nbsp;&nbsp;&nbsp;&nbsp;
NS&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
galaxy.example.com.<br>










1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
IN &nbsp;&nbsp;&nbsp;&nbsp;
PTR &nbsp; &nbsp;&nbsp;&nbsp; galaxy.example.com.<br>










;<br>










201&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
IN &nbsp;&nbsp;&nbsp;&nbsp;
PTR &nbsp; &nbsp; &nbsp; wkstn1.example.com. &nbsp; &nbsp; ; MANUAL entry for 'wkstn1' reverse delegation<br>










202 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
IN &nbsp;&nbsp;&nbsp;&nbsp;
PTR &nbsp; &nbsp; &nbsp; wkstn2.example.com. &nbsp; &nbsp; ; MANUAL entry for 'wkstn2' reverse delegation</td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>










<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Caution !!" src="images/caution.gif"></td>













      <td>When configuring the forward and reverse zone
files, ensure the IP addresses and the host names are identical in both
files. Also, DO NOT add DHCP names and addresses into the files, they
will change over time - this can be resolved by using Dynamic DNS below.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>













The following are some of the common parameters (and definitions)
required to configure our zone files.<br>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="font-weight: bold; width: 140px;">Parameter<br>













      </td>













      <td style="font-weight: bold;">Definition<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">$TTL<br>













      </td>













      <td>Time To Live for the
zone file<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">IN<br>













      </td>













      <td>The Internet system<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">SOA<br>













      </td>













      <td>Start Of Authority to
administer zone<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">NS<br>













      </td>













      <td>Name Server for the zone<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">MX<br>













      </td>













      <td>Mail Exchange for the
zone (needs a priority value)<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">A<br>













      </td>













      <td>Address records for
hosts / network equipment<br>













      </td>













    </tr>













    <tr>













      <td style="font-family: monospace; background-color: rgb(220, 220, 220); width: 140px;">CNAME<br>













      </td>













      <td>Canonical name for an
alias (points to "A" record)<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













This line specifies that the host <span style="font-family: monospace;">galaxy.example.com</span>
is the SOA for the zone, and that <span style="font-family: monospace;">sysadmin.example.com</span>
is the email address of the zone's technical contact (sysadmin@example.com).
It is important to note that a period "." at the end of the domain
names indicates they are fully qualified.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SOA&nbsp;&nbsp;&nbsp;&nbsp;
galaxy.example.com.&nbsp; sysadmin.example.com.&nbsp; </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Warning !!" src="images/warning.gif"></td>













      <td>The periods "." located
at the end of fully qualified domain names are
required. Failure to use periods for FQDNs will cause irregular name resolution.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The following entry specifies that <span style="font-family: monospace;">galaxy.example.com</span>
is the mail
exchange for the zone, which has
been set to priority 10. Leave this as standard unless you know what
you are doing, or remove it if you are not running your own email
servers.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; galaxy&nbsp; ;
Mail Exchange </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













That completes the configuration of named and the new forward/reverse zone files for our
"<span style="font-family: monospace;">example.com</span>"
domain name.
The zone files now need to be <span style="font-family: monospace;">chown</span>'d
to the named user account and a symbolic link created to the new <span style="font-family: monospace;">chroot()</span>
jailed file.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">chown
named.named /var/named/chroot/var/named/data/master-example.com</span><br>













[bash]# <span style="font-weight: bold;">ln -s /var/named/chroot/var/named/data/master-example.com
/var/named/data/master-example.com<br>










      <br>










      </span>[bash]# <span style="font-weight: bold;">chown
named.named&nbsp;</span><span style="font-weight: bold;">/var/named/chroot/var/named/data/reverse-192.168.1</span><br>













[bash]# <span style="font-weight: bold;">ln -s </span><span style="font-weight: bold;">/var/named/chroot/var/named/data/reverse-192.168.1 </span><span style="font-weight: bold;">/var/named/data/reverse-192.168.1</span><br>










      <span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>The file naming
convention is typical of Fedora Core and may
differ slightly between Linux distributions.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>



















<h3>Checking Your Work</h3>













There are several small programs that are in the BIND package that
allow integrity checking of the named configuration and zone files.
These are great tools to maintain your sanity for testing purposes, as
named can be quite particular about problems in the configuration and
zone files.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">named-checkconf
/etc/named.conf</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>The most common errors
for misconfiguration in the named file
are missing semicolons ";" after parameter settings. </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













The zone file should be checked for format consistency, and should
resemble the above <span style="font-family: monospace;">example.com</span>
zone file (substitutions should be made
for the domain and hosts being configured).<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">named-checkzone -d example.com
/var/named/data/master-example.com</span><span style="font-weight: bold;"></span>









      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  <tr>



      <td>loading "example.com"
from "/var/named/master-example.com"
class "IN"<br>













zone example.com/IN: loaded serial 10<br>













OK<br>













      









    









  
  
  
  
  
  
  
  
  
  </td>



    </tr>



  
  
  
  </tbody>
</table>













<br>

The reverse zone file should also be checked for any errors.<br>

<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">named-checkzone -d 1.168.192.in-addr.arpa </span><span style="font-weight: bold;">/var/named/data/reverse-192.168.1</span></td>



    </tr>



    <tr>



      <td>loading "1.168.192.in-addr.arpa" from "/var/named/data/reverse-192.168.1" class "IN"<br>



zone 1.168.192.in-addr.arpa/IN: loaded serial 10<br>



OK</td>



    </tr>



  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>The most common errors
for misconfiguration in zone files are
missing periods "." at the end of fully qualified domain names -
especially for the SOA line. </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<h2><a name="starting"></a><a href="#top">Starting
BIND</a></h2>













After BIND has been configured and there are no errors being returned
from the check applications, it is time to set the runlevels and start
the service.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">chkconfig
--level 2345 named
on</span><br>













[bash]# <span style="font-weight: bold;">/etc/init.d/named restart</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













A manual check after setting the runlevels confirms that named should
start properly after a system reboot.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">chkconfig --list
named</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













Once the service has been started, check the system log to see if there
are any runtime errors, and that your newly configured zone is being
served successfully. The entries <span style="font-family: monospace;">"zone
example.com/IN: loaded serial 10"</span>
&nbsp;and <span style="font-family: monospace;">"zone 1.168.192.in-addr.arpa/IN: loaded serial 10"</span> confirms the zone load was
successful and can now be queried.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">grep named
/var/log/messages</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>galaxy named[19111]: starting BIND 9.3.2 -u named -t /var/named/chroot<br>








galaxy named[19111]: found 2 CPUs, using 2 worker threads<br>








galaxy named[19111]: loading configuration from '/etc/named.conf'<br>








galaxy named[19111]: listening on IPv4 interface lo, 127.0.0.1#53<br>








galaxy named[19111]: listening on IPv4 interface eth1, 192.168.1.1#53<br>








galaxy named[19111]: command channel listening on 127.0.0.1#953<br>








galaxy named[19111]: zone 0.in-addr.arpa/IN: loaded serial 42<br>








galaxy named[19111]: zone 0.0.127.in-addr.arpa/IN: loaded serial 1997022700<br>








galaxy named[19111]: zone <span style="font-weight: bold;">1.168.192.in-addr.arpa/IN</span>: loaded serial
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span style="color: rgb(255, 0, 0); font-weight: bold;">&lt;-- Successful load</span><br>








galaxy named[19111]: zone 255.in-addr.arpa/IN: loaded serial 42<br>








galaxy named[19111]: zone <span style="font-weight: bold;">example.com/IN</span>: loaded serial
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;<span style="color: rgb(255, 0, 0); font-weight: bold;">&lt;-- Successful load</span><br>








galaxy named[19111]: zone localdomain/IN: loaded serial 42<br>








galaxy named[19111]: zone localhost/IN: loaded serial 42<br>








galaxy named[19111]: running<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>













<h2><a name="testing"></a><a href="#top">Testing The
Server</a></h2>













Now that you have configured your Linux&nbsp;server to query itself for DNS and you
have
configured the caching server and added your own zone files, its time to
test that everything we did was successful. Using the <span style="font-family: monospace;">dig</span>
application we can check a
name resolution for <span style="font-family: monospace;">www.example.com</span>,
remembering that <span style="font-family: monospace;">www</span>
in
our configuration was
an alias that really pointed to <span style="font-family: monospace;">galaxy.example.com</span>.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">dig
www.example.com</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  <tr>

      <td>; &lt;&lt;&gt;&gt; DiG 9.3.2 &lt;&lt;&gt;&gt; www.example.com<br>











;; global options:&nbsp; printcmd<br>











;; Got answer:<br>











;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 48535<br>











;; flags: qr aa rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 1, ADDITIONAL: 0<br>











      <br>











;; QUESTION SECTION:<br>











;www.example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A<br>











      <br>











;; ANSWER SECTION:<br>











www.example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp;
galaxy.example.com.<br>











galaxy.example.com.&nbsp;&nbsp;&nbsp;&nbsp; 86400&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
192.168.1.1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;-- Correct IP address returned</span><br>











      <br>











;; AUTHORITY SECTION:<br>











example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; galaxy.example.com.<br>











      <br>











;; Query time: 3 msec<br>










      <span style="font-weight: bold;">
;; SERVER: 127.0.0.1#53(127.0.0.1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 0, 0);">&lt;-- Query from local server</span></span><br>











;; WHEN: Wed May 17 21:16:38 2006<br>











;; MSG SIZE&nbsp; rcvd: 84</td>

    </tr>

  
  </tbody>
</table>













<br>













The above results return the true <span style="font-family: monospace;">CNAME</span>
for <span style="font-family: monospace;">www</span>,
and also the A
record for <span style="font-family: monospace;">galaxy.example.com</span>
being <span style="font-family: monospace;">192.168.1.1</span>.
In the
footer area the query server is set as <span style="font-family: monospace;">127.0.0.1#53</span>,
this is the
nameserver we originally set in the <span style="font-family: monospace;">/etc/resolv.conf</span>
file, itself.<br>













<br>













We can now check a complete listing of the whole zone file with the
following command.<br>













<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">dig example.com
AXFR @localhost</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  <tr>

      <td>; &lt;&lt;&gt;&gt; DiG 9.3.2 &lt;&lt;&gt;&gt; example.com AXFR @localhost<br>











; (1 server found)<br>











;; global options:&nbsp; printcmd<br>











example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SOA&nbsp;&nbsp;&nbsp;&nbsp; galaxy.example.com. sysadmin.example.com. 10
28800 7200 2419200 86400<br>











example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; galaxy.example.com.<br>











example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10 galaxy.example.com.<br>








example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.1<br>











ftp.example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp;
galaxy.example.com.<br>











galaxy.example.com.&nbsp;&nbsp;&nbsp;&nbsp; 86400&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
192.168.1.1<br>











wkstn1.example.com.&nbsp;&nbsp;&nbsp;&nbsp; 86400&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
192.168.1.201<br>











wkstn2.example.com.&nbsp;&nbsp;&nbsp;&nbsp; 86400&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
192.168.1.202<br>











www.example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp;
galaxy.example.com.<br>











example.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SOA&nbsp;&nbsp;&nbsp;&nbsp; galaxy.example.com. sysadmin.example.com. 10
28800 7200 2419200 86400<br>











;; Query time: 2 msec<br>










      <span style="font-weight: bold;">
;; SERVER: 127.0.0.1#53(127.0.0.1)</span><span style="font-weight: bold;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 0, 0);">&lt;-- Query from local server</span></span><br>











;; WHEN: Wed May 17 21:17:21 2006<br>











;; XFR size: 9 records (messages 1)</td>

    </tr>

  
  </tbody>
</table>













<br>













The most important test is that we are able to successfully
resolve domain names that are listed externally to our private network,
and cached from the many Internet DNS servers.<span style="font-weight: bold;"></span><br>
<span style="font-weight: bold;">












</span><br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">dig fedora.redhat.org</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  <tr>

      <td>; &lt;&lt;&gt;&gt; DiG 9.3.2 &lt;&lt;&gt;&gt; fedora.redhat.org<br>











;; global options:&nbsp; printcmd<br>











;; Got answer:<br>











;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 2193<br>











;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 2<br>











      <br>











;; QUESTION SECTION:<br>











;fedora.redhat.org.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A<br>











      <br>











;; ANSWER SECTION:<br>











fedora.redhat.org.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
120&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 65.38.107.197<br>











      <br>











;; AUTHORITY SECTION:<br>











redhat.org.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns1.ireithost.com.<br>











redhat.org.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
86400&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns2.ireithost.com.<br>











      <br>











;; ADDITIONAL SECTION:<br>











ns1.ireithost.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 156739&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
65.38.107.198<br>











ns2.ireithost.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 156739&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
65.38.109.156<br>











      <br>











;; Query time: 395 msec<br>










      <span style="font-weight: bold;">
;; SERVER: 127.0.0.1#53(127.0.0.1)</span><span style="font-weight: bold;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: rgb(255, 0, 0);">&lt;-- Query from local server</span></span><br>











;; WHEN: Wed May 17 21:18:36 2006<br>











;; MSG SIZE&nbsp; rcvd: 132</td>

    </tr>

  
  </tbody>
</table>













<br>

Our last test is to confirm that reverse name lookup is available by querying the reverse delegation zone.<br>








<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">host 192.168.1.201</span><br>













      </td>













    </tr>













  
  
  
  
  <tr>








      <td>201.1.168.192.in-addr.arpa domain name pointer wkstn1.example.com.</td>








    </tr>








  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>













Now that the DNS set up is complete, the rest of the workstations
inside the private network must be configured to use DNS
192.168.1.1 as the primary name server. For Linux clients this should
be listed in /etc/resolv.conf, for Windows clients this should be
configured in network settings.<br>













<br>













If your internal network is using DHCP to provide IP addresses to your
workstations, then "<span style="font-family: monospace;">option
domain-name-servers 192.168.1.1;</span>"
should be set in your
<span style="font-family: monospace;">"/etc/dhcpd.conf"</span> configuration file.<br>











<br>











<h2><a name="dynamic_dns"></a><a href="#top">Configuring Dynamic DNS</a></h2>











As you would have noticed, configuring the forward and reverse zones
for a single domain name can take some time to set up correctly and the
information these zone files contain are pretty much static, ie they
shouldn't change much. However when an IP address or name does change
the information in the zone files also need to be changed otherwise the
incorrect details will be returned from our DNS server when queried.<br>

<br>

To automate this, we use Dynamic DNS. The Internet Systems Consortium
corporation (ISC) write both of the BIND and DHCP server suites that
are utilised within Fedora Core, when both of these server applications
are utilised together, they are able to update themselves whenever
details change between DHCP and DNS. This allows an easy method for the
forward and reverse DNS zone files to be updated when a dynamic host is
allocated an IP address from the DHCP server.<br>

<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Caution !!" src="images/caution.gif"></td>













      <td>The following configuration adjustments assume you have already configured your ISC DHCP daemon in accordance with <a href="10-DHCP_Server.html">Chapter 10</a>; please do this first.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<br>

To configure Dynamic DNS, we can generate a basic set
of&nbsp;configuration files by running the rndc-confgen application.
The first half of the output goes into the <span style="font-family: monospace;">"/etc/rndc.conf"</span> file, while the remaining half of the output goes into the <span style="font-family: monospace;">"/etc/named.conf"</span> file.<br>

<br>




<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">




  <tbody>




    <tr>




      <td>[bash]# <span style="font-weight: bold;">rndc-confgen</span><br>













      </td>




    </tr>




    <tr>




      <td><span style="font-weight: bold; text-decoration: underline; color: rgb(255, 0, 0);"></span>key "rndckey" { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;-- Insert first section into /etc/rndc.conf file</span><br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; algorithm hmac-md5;<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; secret "rZvmZb1cOtvkUfacVZ6oKA==";<br>




};<br>




      <br>




options {<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default-key "rndckey";<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default-server 127.0.0.1;<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default-port 953;<br>




}; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;-- End of first section</span><span style="font-weight: bold; color: rgb(255, 0, 0);"></span><br>




      <br>




key "rndckey" { &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;-- Insert second section into /etc/named.conf file</span><br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; algorithm hmac-md5;<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; secret "rZvmZb1cOtvkUfacVZ6oKA==";<br>




};<br>




      <br>




controls {<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inet 127.0.0.1 port 953<br>




&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allow { 127.0.0.1; } keys { "rndckey"; };<br>




}; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;-- End of second section</span></td>




    </tr>




  
  
  
  
  </tbody>
</table>




<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Warning !!" src="images/warning.gif"></td>













      <td>Ensure the <span style="font-weight: bold; font-family: monospace;">"include&nbsp;/etc/rndc.key"</span> directive is removed (or commented out) from both the <span style="font-weight: bold; font-family: monospace;">/etc/rndc.conf</span> and <span style="font-weight: bold; font-family: monospace;">/etc/named.conf</span> files, as you have now created a new configuration. Only ensure there is only ONE <span style="font-weight: bold; font-family: monospace;">"controls"</span> directive in <span style="font-weight: bold; font-family: monospace;">/etc/named.conf</span>.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>




<span style="font-weight: bold;"></span>To ensure that all zone updates
are secure, the update requests and transfers are covered using a
secure key (MD5 message hash algorithm) which can be generated easily
with the dnssec-keygen application. This key then needs to be
replicated and shared with the DNS and DHCP server configuration files.<br>




<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr style="font-family: monospace;">













      <td>[bash]# <span style="font-weight: bold;">dnssec-keygen -a HMAC-MD5 -b 128 -n USER DYNAMIC_DNS_KEY<br>





      </span>[bash]#&nbsp;<span style="font-weight: bold;">cat Kdynamic_dns_key*.private</span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr style="font-family: monospace;">










      <td>Private-key-format: v1.2<br>










Algorithm: 157 (HMAC_MD5)<br>










Key:&nbsp;<span style="font-weight: bold;">LBxD9REd0XAEwPYOTZMS0w==</span><span style="font-weight: bold;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: rgb(255, 0, 0);">&lt;-- Shared MD5 Algorithm</span></span><br>




      <span style="font-weight: bold;"></span></td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>The <span style="font-family: monospace;">"Kdynamic_dns_key*"</span> file generated in the above step is safe to delete after the DNS and DHCP configuration files have been updated. </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>










The DNS server configuration file needs to be updated with the secure
key declaration, and the zone file settings will also need to be
allowed to update if they are done so with the secure key.<br>











<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">vi
/etc/named.conf</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  <tr>




      <td>
      <span style="font-weight: bold;">key DYNAMIC_DNS_KEY {</span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp; &nbsp; &nbsp; &nbsp; algorithm hmac-md5;</span><br style="font-weight: bold;">



      <span style="font-weight: bold;">&nbsp; &nbsp; &nbsp; &nbsp; secret LBxD9REd0XAEwPYOTZMS0w==;</span><span style="font-weight: bold;"> &nbsp; &nbsp;&nbsp;</span><span style="font-weight: bold;">&nbsp; &nbsp;&nbsp; &nbsp;<span style="color: rgb(255, 0, 0);">&lt;-- Shared MD5 Algorithm</span></span><br style="font-weight: bold;">



      <span style="font-weight: bold;">};</span><br style="font-weight: bold;">



      <br>



zone "example.com" IN {<br>



&nbsp; &nbsp; &nbsp; &nbsp; type master;<br>



&nbsp; &nbsp; &nbsp; &nbsp; file "data/master-example.com";<br>



&nbsp; &nbsp; &nbsp; &nbsp; allow-update { <span style="font-weight: bold;">key DYNAMIC_DNS_KEY;</span> };<span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;<span style="color: rgb(255, 0, 0);">&lt;-- Allow "key" update</span></span><span style="font-weight: bold;"><span style="color: rgb(255, 0, 0);"></span></span><br>



};<br>



      <br>



zone "1.168.192.in-addr.arpa" IN {<br>



&nbsp; &nbsp; &nbsp; &nbsp; type master;<br>



&nbsp; &nbsp; &nbsp; &nbsp; file "data/reverse-192.168.1";<br>



&nbsp; &nbsp; &nbsp; &nbsp; allow-update { <span style="font-weight: bold;">key DYNAMIC_DNS_KEY;</span> };<span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp;<span style="color: rgb(255, 0, 0);">&lt;-- Allow "key" update</span></span><br>



};
      </td>




    </tr>




  
  
  
  
  </tbody>
</table>













<br>











Now the DHCP server configuration file needs to updated with the same
secure key declarations. The server is also told where the primary zone
files are stored (on 127.0.0.1) so they can update the DNS server.<br>











<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">vi
/etc/dhcpd.conf</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  <tr>




      <td>
      key DYNAMIC_DNS_KEY {<br>



&nbsp; &nbsp; &nbsp; &nbsp; algorithm hmac-md5;<br>



&nbsp; &nbsp; &nbsp; &nbsp;       secret <span style="font-weight: bold;">LBxD9REd0XAEwPYOTZMS0w==;</span><span style="font-weight: bold;"> &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;<span style="color: rgb(255, 0, 0);">&lt;-- Shared MD5 Algorithm</span></span><br>



}<br>



      <br>



zone example.org. {<br>



&nbsp; &nbsp; &nbsp; &nbsp;       primary 127.0.0.1;<br>



&nbsp; &nbsp; &nbsp; &nbsp;       key DYNAMIC_DNS_KEY;<span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span style="color: rgb(255, 0, 0);">&lt;-- Allow "key" update</span></span><span style="font-weight: bold;"><span style="color: rgb(255, 0, 0);"></span></span><br>



}<br>



      <br>



zone 1.168.192.in-addr.arpa. {<br>



&nbsp; &nbsp; &nbsp; &nbsp;       primary 127.0.0.1;<br>



&nbsp; &nbsp; &nbsp; &nbsp;       key DYNAMIC_DNS_KEY;<span style="font-weight: bold;">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span style="color: rgb(255, 0, 0);">&lt;-- Allow "key" update</span></span><br>



}
      </td>




    </tr>




  
  
  
  
  </tbody>
</table>













<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Caution !!" src="images/caution.gif"></td>













      <td>The secure key must match in both the <span style="font-weight: bold; font-family: monospace;">"/etc/named.conf"</span> and <span style="font-family: monospace; font-weight: bold;">"/etc/dhcpd.conf"</span> files otherwise Dynamic DNS will not work effectively.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













<br>




The DHCP server must now be configured to allow client updates, make the following two changes to your <span style="font-weight: bold; font-family: monospace;">"/etc/dhcpd.conf"</span> file.<br>











<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr style="font-family: monospace;">













      <td>[bash]# <span style="font-weight: bold;">vi /etc/dhcpd.conf<br>










      </span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr style="font-family: monospace;">










      <td>#<br>




#&nbsp;&nbsp; DHCP Server Config File<br>




#<span style="font-weight: bold;"><br>




ddns-update-style interim;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="font-weight: bold; color: rgb(255, 0, 0);">&lt;--- Change these in /etc/dhcpd.conf</span><br style="font-weight: bold;">




      <span style="font-weight: bold;">allow client-updates;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: rgb(255, 0, 0); font-weight: bold;">&lt;--- Change these in /etc/dhcpd.conf</span>


      </td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>










<br>










The DHCP daemon now needs to be configured for Dynamic DNS updates.<br>










<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">vi /etc/sysconfig/named<br>










      </span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr>










      <td>OPTIONS=-4<br>







ENABLE_ZONE_WRITE=yes<br>







ROOTDIR=/var/named/chroot<br>







      </td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<br>













<table style="width: 100%; text-align: left;" border="1" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="vertical-align: middle; text-align: center; width: 52px;"><img style="width: 24px; height: 24px;" alt="Note !!" src="images/note.gif"></td>













      <td>For detailed information about named daemon, type <span style="font-weight: bold; font-family: monospace;">"man named"</span> at the command prompt.<br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>









Now that the Dynamic DNS configurations are complete, the services need to be restarted.<br>







<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">/etc/init.d/dhcpd restart<br>










      </span>[bash]# <span style="font-weight: bold;">/etc/init.d/named restart</span><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>












<br>

Allow your Dynamic DNS configuration a little time to run (enough for
some DHCP clients to renew IP Addresses) and then check the syslog to
see if your server is successfully updating the forward and reverse
zone files with the new client information.<br>








<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]#&nbsp;<span style="font-weight: bold;">grep dhcpd /var/log/messages</span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr>










      <td>dhcpd: if&nbsp;wkstn3.example.com IN TXT
"3168f50e8140ac8a1c8b84d809c6adbefe" rrset exists
and&nbsp;wkstn3.example.com IN A 192.168.1.200 rrset exists
delete&nbsp;wkstn3.example.com IN A 192.168.1.200: success.<br>



dhcpd: if&nbsp;wkstn3.example.com IN A rrset doesn't exist
delete&nbsp;wkstn3.example.com IN TXT
"3168f50e8140ac8a1c8b84d809c6adbefe": success.<br>



dhcpd: removed reverse map on 200.1.168.192.in-addr.arpa.<br>



dhcpd: DHCPRELEASE of 192.168.1.200 from 00:13:d4:2e:3b:d6 (wkstn3) via eth1 (found)<br>



dhcpd: DHCPDISCOVER from 00:13:d4:2e:3b:d6 via eth1<br>



dhcpd: DHCPOFFER on 192.168.1.200 to 00:13:d4:2e:3b:d6 (wkstn3) via eth1<br>



dhcpd: <span style="font-weight: bold;">Added new forward map from&nbsp;wkstn3.example.com to 192.168.1.200</span><br>



dhcpd: <span style="font-weight: bold;">added reverse map from 200.1.168.192.in-addr.arpa. to&nbsp;wkstn3.example.com</span></td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<br>








The named daemon will also add entries to the syslog to identify correct/successful operation.<br>

<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]#&nbsp;<span style="font-weight: bold;">grep named /var/log/messages</span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr>










      <td>named: client 127.0.0.1#32769: updating zone 'example.com/IN': adding an RR at 'wkstn3.example.com' A<br>



named: client 127.0.0.1#32769: updating zone 'example.com/IN': adding an RR at 'wkstn3.example.com' TXT<br>



named: client 127.0.0.1#32769: updating zone '1.168.192.in-addr.arpa/IN': deleting rrset at '200.1.168.192.in-addr.arpa' PTR<br>



named: client 127.0.0.1#32769: updating zone '1.168.192.in-addr.arpa/IN': adding an RR at '200.1.168.192.in-addr.arpa' PTR</td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>











<br>

A forward lookup can be checked against a known DHCP client to ensure a successful lookup.<br>











<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-weight: bold;">host wkstn3.example.com<br>










      </span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr>










      <td>wkstn3.example.com has address 192.168.1.200</td>



    </tr>



  
  
  
  </tbody>
</table>



<br>

A reverse lookup can also be done to ensure reverse delegation can also be confirmed.<br>











<br>













<table style="width: 100%; background-color: rgb(220, 220, 220); text-align: left; font-family: monospace;" border="1" cellpadding="5" cellspacing="2">













  <tbody>













    <tr>













      <td>[bash]# <span style="font-family: mon;"><span style="font-weight: bold;">host 192.168.1.200<br>



      </span></span><span style="font-weight: bold;">






      </span><span style="font-weight: bold;"></span><span style="font-weight: bold;"></span>


      </td>













    </tr>













  
  
  <tr>










      <td>200.1.168.192.in-addr.arpa domain name pointer wkstn3.example.com<br>







      </td>










    </tr>










  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>










<br>

If you have got this far, you have done well - enjoy a fully automated Dynamic DNS solution.<br>



<br>













<span style="font-weight: bold;"><br>













</span>
<hr>
<table style="width: 100%;" border="0" cellpadding="2" cellspacing="2">













  <tbody>













    <tr>













      <td style="width: 30%; text-align: left;"><a href="07-Package_Management.html">Previous</a><br>













      </td>













      <td style="width: 40%; text-align: center;"><a href="index.html">Home</a>
      </td>













      <td style="width: 30%; text-align: right;"><a href="09-Network_Time_Protocol.html">Next</a><br>













      </td>













    </tr>













  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>













</body>
</html>
